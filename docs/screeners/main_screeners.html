<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Main Screeners</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark-dimmed.css">
  <style>
    #screenerButtons button {
        padding: 7px 20px; /* Adjust padding to make the button smaller */
        margin: 3px;
        font-size: 19px;
        height: auto;
        width: auto;
    }
  </style>
</head>
<body>
<main class="container">
  <!--  <label for="market">Choose a Market:</label>-->
  <div id="screenerButtons" class="container">
    <!--  type is search so it applies the rounded button styles  -->
    <button type="search" class="secondary">Stocks (legacy)</button>
    <button type="search" class="outline secondary">Stocks (v2)</button>
    <button type="search" class="outline secondary">Forex</button>
    <button type="search" class="outline secondary">Crypto</button>
    <button type="search" class="outline secondary">Crypto Coins</button>
    <button type="search" class="outline secondary">ETFs</button>
    <button type="search" class="outline secondary">Bonds</button>
  </div>
  <pre>
    <code id="queryAsPythonCode" class="language-javascript"></code>
  </pre>
  <div>
    <span>Last updated: 2025-02-03 07:02:10</span>
  </div>
</main>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
<script type="text/javascript">
  const screenerNameToCodeMapping = {"Stocks (legacy)": "(Query()\n .select(\n     'logoid',\n     'name',\n     'close',\n     'change',\n     'change_abs',\n     'Recommend.All',\n     'volume',\n     'Value.Traded',\n     'market_cap_basic',\n     'price_earnings_ttm',\n     'earnings_per_share_basic_ttm',\n     'number_of_employees',\n     'sector',\n     'description',\n     'type',\n     'subtype',\n     'update_mode',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n     'currency',\n     'fundamental_currency_code',\n )\n .where(\n     col('type').isin(['stock', 'dr', 'fund']),\n     col('subtype').isin(\n         ['common', 'foreign-issuer', '', 'etf', 'etf,odd', 'etf,otc', 'etf,cfd']\n     ),\n     col('exchange').isin(['AMEX', 'NASDAQ', 'NYSE']),\n     col('is_primary') == True,\n     col('active_symbol') == True,\n )\n .order_by('market_cap_basic', ascending=False)\n .limit(150)\n .set_markets('america'))", "Stocks (v2)": "(Query()\n .select(\n     'name',\n     'description',\n     'logoid',\n     'update_mode',\n     'type',\n     'typespecs',\n     'close',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n     'currency',\n     'change',\n     'volume',\n     'relative_volume_10d_calc',\n     'market_cap_basic',\n     'fundamental_currency_code',\n     'price_earnings_ttm',\n     'earnings_per_share_diluted_ttm',\n     'earnings_per_share_diluted_yoy_growth_ttm',\n     'dividends_yield_current',\n     'sector.tr',\n     'market',\n     'sector',\n     'recommendation_mark',\n     'exchange',\n )\n .where2(\n     And(\n         Or(\n             And(col('type') == 'stock', col('typespecs').has(['common'])),\n             And(col('type') == 'stock', col('typespecs').has(['preferred'])),\n             And(col('type') == 'dr'),\n             And(col('type') == 'fund', col('typespecs').has_none_of(['etf'])),\n         )\n     )\n )\n .order_by('market_cap_basic', ascending=False)\n .limit(100)\n .set_markets('america')\n .set_property('ignore_unknown_fields', False)\n .set_property('symbols', {}))", "Forex": "(Query()\n .select(\n     'base_currency_logoid',\n     'currency_logoid',\n     'name',\n     'close',\n     'change',\n     'change_abs',\n     'bid',\n     'ask',\n     'high',\n     'low',\n     'Recommend.All',\n     'description',\n     'type',\n     'subtype',\n     'update_mode',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n )\n .where(col('sector').isin(['Major', 'Minor']))\n .order_by('name', ascending=True)\n .limit(150)\n .set_markets('forex')\n .set_property('symbols', {'query': {'types': ['forex']}, 'tickers': []}))", "Crypto": "(Query()\n .select(\n     'base_currency_logoid',\n     'currency_logoid',\n     'name',\n     'close',\n     'change',\n     'change_abs',\n     'high',\n     'low',\n     'volume',\n     '24h_vol|5',\n     '24h_vol_change|5',\n     'Recommend.All',\n     'exchange',\n     'description',\n     'type',\n     'subtype',\n     'update_mode',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n )\n .order_by('24h_vol|5', ascending=False)\n .limit(150)\n .set_markets('crypto')\n .set_property('price_conversion', {'to_symbol': False}))", "Crypto Coins": "(Query()\n .select(\n     'base_currency',\n     'base_currency_desc',\n     'base_currency_logoid',\n     'update_mode',\n     'type',\n     'typespecs',\n     'exchange',\n     'crypto_total_rank',\n     'close',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n     'currency',\n     '24h_close_change|5',\n     'market_cap_calc',\n     'fundamental_currency_code',\n     '24h_vol_cmc',\n     'circulating_supply',\n     'crypto_common_categories.tr',\n )\n .order_by('crypto_total_rank', ascending=True)\n .limit(100)\n .set_markets('coin')\n .set_property('ignore_unknown_fields', False)\n .set_property('symbols', {}))", "ETFs": "(Query()\n .select(\n     'name',\n     'description',\n     'logoid',\n     'update_mode',\n     'type',\n     'typespecs',\n     'close',\n     'pricescale',\n     'minmov',\n     'fractional',\n     'minmove2',\n     'currency',\n     'change',\n     'Value.Traded',\n     'relative_volume_10d_calc',\n     'aum',\n     'fundamental_currency_code',\n     'nav_total_return.3Y',\n     'expense_ratio',\n     'asset_class.tr',\n     'focus.tr',\n     'exchange',\n )\n .where2(\n     And(\n         Or(\n             And(col('typespecs').has(['etn'])),\n             And(col('typespecs').has(['etf'])),\n             And(col('type') == 'structured'),\n         )\n     )\n )\n .order_by('aum', ascending=False)\n .limit(100)\n .set_markets('america')\n .set_property('ignore_unknown_fields', False)\n .set_property('symbols', {}))", "Bonds": "(Query()\n .select(\n     'name',\n     'description',\n     'logoid',\n     'update_mode',\n     'type',\n     'typespecs',\n     'country.tr',\n     'country_code_fund',\n     'bond_issuer_type.tr',\n     'close_net',\n     'fundamental_currency_code',\n     'close_pct',\n     'volume',\n     'yield_to_maturity',\n     'current_coupon',\n     'maturity_date',\n     'redemption_type.tr',\n     'bond_snp_rating_lt.tr',\n )\n .order_by('volume', ascending=False)\n .limit(100)\n .set_markets('bond')\n .set_property('ignore_unknown_fields', False)\n .set_property('symbols', {}))"};
  const screenerButtons = document.getElementById('screenerButtons').children;
  var lastActiveButton = screenerButtons[0];  // this is needed to track which was the previous button that we highlighted, to un-highlight it.
  const queryCode = document.getElementById('queryAsPythonCode');


  window.onload = function() {
    // when you click the button the style changes (toggles the outline), and it updates the Python code for that screener
    for (let i = 0; i < screenerButtons.length; i++) {
      screenerButtons[i].addEventListener('click', (event) => {
        lastActiveButton.classList.add('outline');
        event.target.classList.remove('outline');
        lastActiveButton = event.target;

        queryCode.innerHTML = screenerNameToCodeMapping[event.target.textContent];
        queryCode.removeAttribute('data-highlighted')
        hljs.highlightAll()
      })
    }

    lastActiveButton.click();  // this is needed at the beginning, so it populates the code from the first screener-button
  }
</script>
</body>
</html>